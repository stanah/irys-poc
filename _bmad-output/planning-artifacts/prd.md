---
stepsCompleted:
  - step-01-init
  - step-02-discovery
  - step-03-success
  - step-04-journeys
classification:
  projectType: 'blockchain_web3 + web_app'
  domain: 'media_entertainment'
  domainSubconcerns: 'fintech (P2P tipping, revenue split, 資金決済法)'
  complexity: 'high'
  projectContext: 'brownfield'
inputDocuments:
  - '_bmad-output/planning-artifacts/product-brief-irys-poc-2026-02-02.md'
  - '_bmad-output/planning-artifacts/research/market-decentralized-video-monetization-research-2026-02-01.md'
  - '_bmad-output/planning-artifacts/research/technical-irys-livepeer-lit-architecture-research-2026-02-02.md'
  - '_bmad-output/brainstorming/brainstorming-session-2026-02-01.md'
  - 'docs/index.md'
  - 'docs/project-overview.md'
  - 'docs/architecture.md'
  - 'docs/source-tree-analysis.md'
  - 'docs/development-guide.md'
  - 'docs/component-inventory.md'
  - 'docs/api-contracts.md'
  - 'docs/research/livepeer-theta-comparison.md'
documentCounts:
  briefs: 1
  research: 2
  brainstorming: 1
  projectDocs: 8
workflowType: 'prd'
date: '2026-02-03'
author: 'stanah'
---

# Product Requirements Document - irys-poc

**Author:** stanah
**Date:** 2026-02-03

## Success Criteria

### User Success

| 成功基準 | 測定方法 | 成功の定義 |
|---------|---------|-----------|
| **投げ銭の100%到達確認（送り手体験）** | 投げ銭送信後のオンチェーントランザクション表示 | ファンが送金→クリエイターへの到達をUI上で確認できる |
| **投げ銭の100%到達確認（受け手体験）** | クリエイター側の受領通知・履歴表示 | クリエイターが受け取った投げ銭を確認できる |
| **公開動画の視聴** | アップロード→再生の全フロー完了 | 誰でも公開動画をシームレスに視聴できる |
| **限定動画の視聴** | ACC検証→復号→再生の全フロー完了 | 条件を満たすユーザーのみが限定動画を視聴できる |
| **Web2ライクなオンボーディング** | AA経由でのアカウント作成→動画視聴→投げ銭 | MetaMask未所持ユーザーがメール/SNSログインで利用開始できる |
| **オンボーディング完了ステップ数** | ステップ数計測 | **3ステップ以内**（ログイン→プロフィール確認→動画視聴開始） |

### Business Success

| 成功基準 | 測定方法 | 成功の定義 |
|---------|---------|-----------|
| **PoC技術実証（3ヶ月後）** | 全パイプラインの動作確認 | 公開・限定両パイプラインが一気通貫で動作する |
| **運用コストの把握** | 各プロトコルの実効コスト計測・記録 | 下記コスト内訳が実測値として記録されている |
| **プラットフォーム固定コスト計測** | ホスティング・ドメイン等の月間費用記録 | 月間固定コストの実額が把握できている |
| **アクティブクリエイター（12ヶ月後）** | ユニーククリエイターアドレス数 | 5人以上 |
| **月間投げ銭（12ヶ月後）** | オンチェーントランザクション数 | 月10件以上 |

**コスト内訳記録項目:**

| コスト項目 | 計測対象 | 単位 |
|-----------|---------|------|
| Irysストレージ | 永続ストレージ | $/GB |
| Livepeerトランスコード | 動画変換 | $/分 |
| Lit復号 | Naga使用量課金 | $/リクエスト |
| ホスティング | Vercel等 | $/月 |
| ドメイン | ドメイン維持 | $/年 |

### Technical Success

| 成功基準 | 測定方法 | 成功の定義 |
|---------|---------|-----------|
| **公開動画パイプライン** | E2Eテスト | アップロード→Livepeerトランスコード→Irys保存→HLS再生が正常完了 |
| **限定動画パイプライン** | E2Eテスト | アップロード→トランスコード→Lit暗号化→Irys保存→ACC検証→復号→再生が正常完了 |
| **限定動画初回再生開始時間** | パフォーマンス計測 | **目標: 3秒以内** |
| **投げ銭パイプライン** | コントラクトテスト | VideoTippingコントラクトによるP2P直接送金＋収益分配が正常動作 |
| **投げ銭確認表示時間** | パフォーマンス計測 | 送信→オンチェーン確認表示までの時間を**計測・記録** |
| **AA統合** | オンボーディングフローテスト | Alchemy Account Kit経由でメール/SNSログイン→動画視聴→投げ銭が可能 |
| **復号コスト実測** | Lit Naga使用量ログ | 限定動画1再生あたりのLit復号コストが計測・記録されている |
| **テストインフラ** | Playwrightセットアップ | E2Eテストフレームワークが稼働し、主要パイプラインのテストが自動実行可能 |

### Measurable Outcomes

**PoC完了判定（全項目を満たすこと）:**
1. 公開動画を10本以上アップロード・再生確認
2. 限定動画の暗号化→復号→再生フロー動作確認
3. AA経由のオンボーディングフロー動作確認
4. 投げ銭のオンチェーン到達確認（送り手・受け手双方のUI）
5. 各プロトコルの実効コスト（Irys, Livepeer, Lit）が記録されている
6. E2Eテストフレームワーク（Playwright）がセットアップされ、主要フローのテストが通過

## Product Scope

### 前提条件（MVPの前に完了必須）

| 条件 | 期限 | 詳細 |
|------|------|------|
| **Lit Protocol Naga移行** | 2026/2/25 | SDK v8 + Nagaネットワークでの暗号化/復号化動作確認 |

### MVP — Minimum Viable Product（P0-A + P0-B）

**P0-A: 公開動画の一気通貫**
- 公開動画アップロード（Livepeer TUS→トランスコード→Irys保存）
- 公開動画再生（Irys Gateway→HLS再生）
- 動画メタデータ（タイトル、説明、カテゴリ、アクセスタイプ）
- MetaMask接続
- タグベースフィルタリング（Irys GraphQL）

**P0-B: コアバリューの実現**
- 限定動画アップロード（トランスコード→Lit暗号化→Irys保存）
- 限定動画再生（ACC検証→復号→HLS再生）
- 投げ銭（VideoTippingコントラクトによるP2P直接送金）
- アカウントアブストラクション（Alchemy Account Kit）
- 復号コスト実測・記録

**テストインフラ**
- Playwrightセットアップ
- 主要パイプライン（公開動画、限定動画、投げ銭、AA）のE2Eテスト

**MVP完了判定:** 上記全パイプラインが動作し、Measurable Outcomesの6項目を満たした時点。

### Growth Features（Post-MVP / P1）

- HLSアダプティブビットレート（品質選択）
- 投げ銭履歴一覧（オンチェーンデータ表示）
- `@irys/query`パッケージ採用（GraphQL改善）
- Livepeer Webhook導入（ポーリング→イベント駆動）
- GraphQLエンドポイント環境変数化（Irys L1移行備え）
- クリエイターチャンネルページ

### Vision（Future / Phase 2-3）

- Revenue Split（コラボ制作向け自動収益分配）
- メンバーシップ/サブスクリプション
- AI機能（字幕・翻訳・推薦）
- ファン貢献機能（字幕投稿等）とオンチェーン記録
- AI経済圏への拡張
- DAO化（合同会社型DAO）
- IrysVM Programmable Data活用

## User Journeys

### Journey 1: ファン — 「推しを直接支えたい」

**ペルソナ: ユウキ（22歳）**
フリーランスのWebデザイナー。テック系YouTuberの熱心なファン。推しクリエイターの動画は毎回欠かさず視聴し、コメントも積極的に残す。YouTubeのSuper Chatで投げ銭したことがあるが、「30%も手数料取られるのか…」と少しモヤモヤしていた。MetaMaskは持っていないが、暗号資産には興味がある。

**Opening Scene — 推しからの告知**

ある日、ユウキがいつも見ているテック系クリエイター「TechMaster Ken」がTwitterで告知を投稿する。

> 「新しいプラットフォームでも動画配信始めました！ここなら投げ銭が100%届きます。良かったら覗いてみてください」

リンクをクリックすると、見慣れないUIのサイトが開く。「Web3？ウォレット？」と少し身構えるユウキ。

**Rising Action — 意外とスムーズなオンボーディング**

ログインボタンを押すと「Googleアカウントでログイン」の選択肢が。MetaMaskの設定は不要らしい。Googleアカウントで認証すると、数秒でプロフィール画面に。「あれ、ウォレットとか作らなくていいの？」と拍子抜けするほど簡単。

TechMaster Kenの動画を見つけてクリック。普通に再生が始まる。画質も問題なし。「これ、本当にWeb3なの？」

**Climax — 100%が届く確認の瞬間**

動画を見終えたユウキは、下にある「Tip」ボタンに気づく。「0.01 ETH」のプリセットを選択。「推しに直接届くなら、これくらい…」

送信ボタンを押すと、ローディング表示が現れる:
> ⏳ **トランザクションを処理しています...**
> ブロックチェーンに記録中です。しばらくお待ちください。

10〜30秒後、確認画面が表示される:
> ✅ **TechMaster Ken に 0.01 ETH が届きました**
> トランザクション: 0x7a8b...3f2d（Polygonscanで確認）

「え、これ本当に全額届いたの？」リンクをクリックしてPolygonscanを開く。確かに、自分のアドレスからTechMaster Kenのアドレスへ、手数料を除いた0.01 ETHがそのまま送金されている。プラットフォームの中抜きなし。

**ユウキの心の声:** 「これだ。これが欲しかったんだ。」

**Resolution — 新しい応援のカタチ**

それ以来、ユウキはTechMaster Kenの新作がこのプラットフォームに上がるたびにチェックするようになった。投げ銭の履歴を見ると、自分が「初期サポーター」として記録されている。YouTubeでは得られなかった「直接つながっている感覚」がそこにある。

---

### Journey 1b: ファン — エラーリカバリー「うまくいかない時」

**ペルソナ: ユウキ（22歳）** — Journey 1と同一人物

**シナリオA: 残高不足** ⚡ MVP必須

ユウキは0.01 ETHの投げ銭を送ろうとする。しかし、ウォレット残高が0.005 ETHしかない。

送信ボタンを押すと:
> ⚠️ **残高が不足しています**
> 必要額: 0.01 ETH + ガス代
> 現在の残高: 0.005 ETH
>
> [残高を追加する方法を見る]

リンクをクリックすると、Polygon Amoyテストネットの場合はFaucetへの案内、本番環境ではオンランプへの案内が表示される。

**シナリオB: ネットワークエラー** 📋 P1

投げ銭送信中にネットワークが切断される。

> ⚠️ **送信に失敗しました**
> ネットワーク接続を確認してください。
> トランザクションは送信されていません。残高は変わっていません。
>
> [再試行]

**シナリオC: AAログイン失敗** 📋 P1

Google認証は成功したが、Alchemyのアカウント作成でエラーが発生。

> ⚠️ **アカウント作成に失敗しました**
> しばらく待ってから再度お試しください。
>
> [再試行] [MetaMaskでログイン]

代替手段（MetaMask）への誘導で完全にブロックされない。

---

### Journey 1c: ファン — 限定動画視聴「特別なコンテンツへのアクセス」

**ペルソナ: ユウキ（22歳）** — Journey 1と同一人物

**Opening Scene — 限定動画の発見**

ユウキはTechMaster Kenのチャンネルページを見ていると、「🔒 メンバー限定」というバッジがついた動画を発見する。

**Rising Action — アクセス条件の確認**

動画ページに遷移すると、プレーヤーの代わりにロック画面が表示される:

> 🔒 **この動画は限定公開です**
>
> 視聴条件: TechMaster Kenに0.05 ETH以上の投げ銭履歴がある
>
> あなたの状態: ❌ 条件を満たしていません
> 現在の投げ銭累計: 0.01 ETH
>
> [投げ銭して条件を満たす]

**Climax — 条件達成の瞬間**

ユウキは追加で0.04 ETHを投げ銭。トランザクション確認後、ページが自動更新:

> ✅ **視聴条件を満たしました！**

プレーヤーが表示され、ローディング画面が現れる:
> 🔓 **コンテンツを復号化しています...**
> あなたのウォレットで安全に視聴できるよう準備中です

数秒後、再生が始まる。

**Resolution — 特別な関係性**

限定動画を見終えたユウキは、他の限定動画もチェックし始める。「初期サポーター」としての自分の立場が、単なる視聴者以上のものになっていく。

---

### Journey 2: クリエイター — 「初日から報われる場所」

**ペルソナ: ケン（28歳）= TechMaster Ken**
本業はソフトウェアエンジニア。副業でテック系YouTube動画を投稿。登録者8,000人。YouTubeの収益化条件は満たしているが、収益は月数千円程度。Web3技術に興味があり、新しいプラットフォームを積極的に試す。

**Opening Scene — 新しいプラットフォームとの出会い**

ケンはTwitterで「分散型動画プラットフォーム」の話題を見かける。MetaMaskを持っているケンは、ウォレット接続を選択。数秒で接続完了。

**Rising Action — 初めての動画アップロード**

アップロードページで動画ファイルを選択。タイトル、説明、カテゴリを入力。

アップロードが始まると、進捗バーが表示される:
1. Preparing... ✓
2. Uploading... ✓
3. Transcoding... ✓
4. Storing... ✓
5. Complete!

数分後、自分の動画がプラットフォーム上で再生可能に。

**Climax — 最初の投げ銭を受け取る瞬間**

ケンはTwitterで告知を投稿。数時間後、通知が:

> 🎉 **ユウキさんから 0.01 ETH の投げ銭を受け取りました**

Polygonscanで確認すると、確かに自分のウォレットに0.01 ETHが入っている。プラットフォーム手数料ゼロ。

**ケンの心の声:** 「たった1人のファンでも、直接つながれるんだ。」

**Resolution — 新しい発信の形**

ケンはYouTubeと並行して、このプラットフォームを「コアなファン向けの場所」として運用し始める。

---

### Journey 2b: クリエイター — エラーリカバリー「やり直しの作法」

**ペルソナ: ケン（28歳）** — Journey 2と同一人物

**シナリオA: トランスコード失敗** ⚡ MVP必須

ケンが動画をアップロード。Transcodingで失敗。

> ❌ **トランスコードに失敗しました**
> 原因: 動画フォーマットがサポートされていません
> サポート形式: MP4 (H.264), WebM, MOV
>
> [別の形式で再アップロード]

**シナリオB: TUSリジューマブル再開** 📋 P1

大きな動画をアップロード中、進捗60%でネットワーク切断。再接続後:

> 📁 **前回のアップロードを再開できます**
> ファイル名: my-video.mp4 | 進捗: 60%
>
> [再開] [キャンセルして新規アップロード]

**シナリオC: Irys残高不足** ⚡ MVP必須

> ❌ **ストレージ残高が不足しています**
> 必要額: 0.002 ETH | Irys残高: 0.0005 ETH
>
> [残高を追加] [アップロードをキャンセル]

---

### Journey 3: コラボレーター — 「チームで作る、自動で分ける」（Phase 2）

**ペルソナ: サキ（25歳）**
インディーアニメーション作家。友人のミュージシャンとコラボして短編作品を制作。収益分配が課題。

> **Note:** このジャーニーはPhase 2（Revenue Split実装後）で実現予定。MVPスコープには含まれない。

Revenue Split機能により、動画アップロード時に「収益分配：サキ 60%、リョウ 40%」と設定。投げ銭が入るたびにスマートコントラクトが自動分配。

---

### Journey 4: プラットフォーム運営者 — 「持続可能性を確認する」

**ペルソナ: stanah（開発者 兼 運営者）**

**コスト監視フロー**

stanahは運用コストを計測・記録:

| 項目 | 実測値 |
|------|--------|
| Irysストレージ | $/GB |
| Livepeerトランスコード | $/分 |
| Lit復号 | $/リクエスト |
| Vercelホスティング | $/月 |
| ドメイン | $/年 |

**トラブルシューティングフロー**

障害発生時は以下のステータスページを確認:
- Lit Protocol: https://status.litprotocol.com/
- Livepeer: https://livepeer.statuspage.io/
- Irys: https://status.irys.xyz/

**シナリオ別対応:**

| 障害 | 確認方法 | 対応 |
|------|---------|------|
| Lit障害 | ブラウザコンソール + ステータスページ | 一時的→待機案内、長期→公開動画のみ継続 |
| Livepeer障害 | Studio Dashboard + API | 再試行案内、継続→サポート連絡 |
| Irys障害 | ネットワークタブ + ステータスページ | エンドポイント切替（環境変数化済み） |

---

### Journey Requirements Summary

| 優先度 | ジャーニー | 必要な機能・能力 | テスト |
|--------|-----------|-----------------|--------|
| ⚡ **MVP** | ファン — 成功パス | AAオンボーディング、動画視聴、投げ銭送信、トランザクション確認UI（10-30秒ローディング）、Polygonscanリンク | `e2e/fan-tipping-flow.spec.ts` |
| ⚡ **MVP** | ファン — 残高不足エラー | 残高不足エラー表示、追加方法への案内 | `e2e/fan-tipping-flow.spec.ts` に含む |
| ⚡ **MVP** | ファン — 限定動画視聴 | token-gatedロック画面、視聴条件表示、条件達成判定、Lit復号ローディング（理由表示付き） | `e2e/fan-tokengated-flow.spec.ts` |
| ⚡ **MVP** | クリエイター — 成功パス | MetaMask接続、動画アップロード、トランスコード進捗表示、投げ銭受領通知 | `e2e/creator-upload-flow.spec.ts` |
| ⚡ **MVP** | クリエイター — エラー表示 | フォーマットエラー表示、Irys残高不足エラー | `e2e/creator-upload-flow.spec.ts` に含む |
| 📋 **P1** | ファン — ネットワークエラー | ネットワークエラー表示・再試行ボタン | 手動テスト → P1で自動化 |
| 📋 **P1** | ファン — AAログイン失敗 | エラー表示、MetaMaskフォールバック | 手動テスト → P1で自動化 |
| 📋 **P1** | クリエイター — TUS再開 | リジューマブル再開UI | 手動テスト → P1で自動化 |
| 📋 **P2** | コラボレーター | Revenue Split設定UI、自動分配SC | Phase 2 |
| 📋 **P2** | 運営者 — ダッシュボード | コスト計測ダッシュボード | 手動記録で代替 |
| — | 運営者 — トラブルシューティング | ステータス確認リンク集（ドキュメント化） | 手動確認 |
